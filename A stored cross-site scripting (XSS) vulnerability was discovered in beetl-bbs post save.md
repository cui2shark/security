**target**:https://gitee.com/xiandafu/beetl-bbs  
**affected version:** v2.0  
A stored XSS exists in beetl-bbs via the post/save content parameter, which allows remote attackers to inject arbitrary web script or HTML.

Try to inject JavaScript code into the input box under a certain topic，it can seen that the input code has been encoded. This is because the jQuery serialize method was used during submit.：

![image-20231226234426984](image/stored%20xss%20in%20beetl-bbs/image-20231226234426984.png)

Replace the content field with poc:

```
<script>alert(document.cookie)</script>
```

![image-20231226234508906](image/stored%20xss%20in%20beetl-bbs/image-20231226234508906.png)

successed:

![image-20231226234545181](image/stored%20xss%20in%20beetl-bbs/image-20231226234545181.png)

![image-20231226234709641](image/stored%20xss%20in%20beetl-bbs/image-20231226234709641.png)

Security risks arise from components /post/save .The content field is not encoded or filtered properly, leading to a potential XSS vulnerability:

![image-20231226235149123](image/stored%20xss%20in%20beetl-bbs/image-20231226235149123.png)

![image-20231226235251696](image/stored%20xss%20in%20beetl-bbs/image-20231226235251696.png)

Information Exposure: The cookie set after a successful user login contains an MD5 hash of the user's password. If the user cookie is leaked and the AES encryption key is not changed, an attacker can obtain the password hash and attempt to crack the actual password through hash collision attacks.

![image-20231226235442632](image/stored%20xss%20in%20beetl-bbs/image-20231226235442632.png)

**Summary:** The jQuery serialize method can prevent abnormal transmission of some special characters to some extent, but to completely prevent XSS attacks, strict output filtering and validation on the server side is still required.
